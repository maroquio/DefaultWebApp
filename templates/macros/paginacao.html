{#
Macro de Paginação Bootstrap 5

Uso:
    {% from 'macros/paginacao.html' import paginacao_nav, info_paginacao %}

    -- Barra de navegação completa (próximo, anterior, números):
    {{ paginacao_nav(paginacao, url_base) }}

    -- Informação textual: "Mostrando 1-10 de 47 registros":
    {{ info_paginacao(paginacao) }}

    -- Combinado: info + navegação lado a lado:
    {{ paginacao_completa(paginacao, url_base) }}

Parâmetros:
    paginacao: Objeto Paginacao retornado por util/paginacao_util.py
    url_base: URL base da página SEM query string (ex: '/admin/usuarios')
              O macro adiciona ?pagina=N automaticamente.
              Para URLs com outros parâmetros, use url_extra:
              {{ paginacao_nav(paginacao, '/produtos', url_extra='&status=ativo') }}

Exemplo completo no template:
    {% from 'macros/paginacao.html' import paginacao_completa %}

    {% for item in paginacao.items %}
        ...
    {% endfor %}

    {{ paginacao_completa(paginacao, '/lista') }}
#}

{% macro paginacao_nav(paginacao, url_base, url_extra='', size='') %}
{#
Renderiza a barra de navegação de páginas (Previous, 1, 2, ..., Next).

Args:
    paginacao: Objeto Paginacao de util/paginacao_util.py
    url_base: URL base sem query string
    url_extra: Parâmetros adicionais na query string (ex: '&busca=termo')
    size: Tamanho da paginação ('sm', '' para normal, 'lg')
#}
{% if paginacao.total_paginas > 1 %}
<nav aria-label="Navegação de páginas">
    <ul class="pagination {% if size %}pagination-{{ size }}{% endif %} mb-0 flex-wrap">

        {# Botão Anterior #}
        <li class="page-item {% if not paginacao.tem_anterior %}disabled{% endif %}">
            {% if paginacao.tem_anterior %}
            <a class="page-link"
               href="{{ url_base }}?pagina={{ paginacao.pagina_anterior }}{{ url_extra }}"
               aria-label="Página anterior">
                <span aria-hidden="true">&laquo;</span>
            </a>
            {% else %}
            <span class="page-link" aria-label="Página anterior" aria-disabled="true">
                <span aria-hidden="true">&laquo;</span>
            </span>
            {% endif %}
        </li>

        {# Números de página #}
        {% for pagina in paginacao.paginas %}
            {% if pagina is none %}
            {# Reticências #}
            <li class="page-item disabled">
                <span class="page-link">…</span>
            </li>
            {% elif pagina == paginacao.pagina_atual %}
            {# Página atual #}
            <li class="page-item active" aria-current="page">
                <span class="page-link">{{ pagina }}</span>
            </li>
            {% else %}
            {# Outras páginas #}
            <li class="page-item">
                <a class="page-link"
                   href="{{ url_base }}?pagina={{ pagina }}{{ url_extra }}">
                    {{ pagina }}
                </a>
            </li>
            {% endif %}
        {% endfor %}

        {# Botão Próxima #}
        <li class="page-item {% if not paginacao.tem_proxima %}disabled{% endif %}">
            {% if paginacao.tem_proxima %}
            <a class="page-link"
               href="{{ url_base }}?pagina={{ paginacao.proxima_pagina }}{{ url_extra }}"
               aria-label="Próxima página">
                <span aria-hidden="true">&raquo;</span>
            </a>
            {% else %}
            <span class="page-link" aria-label="Próxima página" aria-disabled="true">
                <span aria-hidden="true">&raquo;</span>
            </span>
            {% endif %}
        </li>

    </ul>
</nav>
{% endif %}
{% endmacro %}


{% macro info_paginacao(paginacao, texto_singular='registro', texto_plural='registros') %}
{#
Exibe informação textual da paginação: "Mostrando 1-10 de 47 registros"

Args:
    paginacao: Objeto Paginacao de util/paginacao_util.py
    texto_singular: Rótulo no singular (padrão: 'registro')
    texto_plural: Rótulo no plural (padrão: 'registros')
#}
<small class="text-muted">
    {% if paginacao.total == 0 %}
        Nenhum {{ texto_singular }} encontrado
    {% elif paginacao.total == 1 %}
        1 {{ texto_singular }}
    {% else %}
        Mostrando {{ paginacao.inicio }}&ndash;{{ paginacao.fim }}
        de <strong>{{ paginacao.total }}</strong> {{ texto_plural }}
    {% endif %}
</small>
{% endmacro %}


{% macro paginacao_completa(paginacao, url_base, url_extra='', texto_singular='registro', texto_plural='registros', size='') %}
{#
Combinação de info_paginacao + paginacao_nav em layout responsivo.
Exibe texto à esquerda e navegação à direita (em telas maiores).

Args:
    paginacao: Objeto Paginacao de util/paginacao_util.py
    url_base: URL base sem query string
    url_extra: Parâmetros adicionais na query string
    texto_singular: Rótulo no singular
    texto_plural: Rótulo no plural
    size: Tamanho da paginação ('sm', '', 'lg')
#}
{% if paginacao.total > 0 %}
<div class="d-flex flex-column flex-sm-row justify-content-between align-items-center gap-2 mt-3">
    <div>
        {{ info_paginacao(paginacao, texto_singular, texto_plural) }}
    </div>
    <div>
        {{ paginacao_nav(paginacao, url_base, url_extra, size) }}
    </div>
</div>
{% endif %}
{% endmacro %}
